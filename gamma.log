/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/albumentations/core/validation.py:114: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/work/home/shiyan_dong/dsy/Gamma_Challenge/src/dataset.py:181: UserWarning: Argument(s) 'var_limit' are not valid for transform GaussNoise
  A.GaussNoise(var_limit=(10, 50)),
/work/home/shiyan_dong/dsy/Gamma_Challenge/src/dataset.py:219: UserWarning: Argument(s) 'var_limit' are not valid for transform GaussNoise
  A.GaussNoise(var_limit=(5, 30), p=0.2),
[INFO] Using device: cpu
[INFO] Loading data...
[INFO] 加载 100 个有效样本 (train)
[INFO] 加载 100 个有效样本 (val)
[INFO] Train samples: 100
[INFO] Val samples: 100
[INFO] Building model...
Traceback (most recent call last):
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/httpx/_transports/default.py", line 101, in map_httpcore_exceptions
    yield
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/httpx/_transports/default.py", line 250, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 256, in handle_request
    raise exc from None
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/httpcore/_sync/connection_pool.py", line 236, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/httpcore/_sync/http_proxy.py", line 297, in handle_request
    raise ProxyError(msg)
httpcore.ProxyError: 503 Service Unavailable

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/work/home/shiyan_dong/dsy/Gamma_Challenge/src/train.py", line 291, in <module>
    main(args)
  File "/work/home/shiyan_dong/dsy/Gamma_Challenge/src/train.py", line 176, in main
    model = build_model(pretrained=cfg.FUNDUS_PRETRAINED)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/dsy/Gamma_Challenge/src/models/gamma_net.py", line 105, in build_model
    return GammaNet(
           ^^^^^^^^^
  File "/work/home/shiyan_dong/dsy/Gamma_Challenge/src/models/gamma_net.py", line 36, in __init__
    self.fundus_branch = FundusBranch(
                         ^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/dsy/Gamma_Challenge/src/models/fundus_branch.py", line 38, in __init__
    self.backbone = timm.create_model(
                    ^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/timm/models/_factory.py", line 138, in create_model
    model = create_fn(
            ^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/timm/models/efficientnet.py", line 2112, in efficientnet_b4
    model = _gen_efficientnet(
            ^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/timm/models/efficientnet.py", line 762, in _gen_efficientnet
    model = _create_effnet(variant, pretrained, **model_kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/timm/models/efficientnet.py", line 463, in _create_effnet
    model = build_model_with_cfg(
            ^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/timm/models/_builder.py", line 457, in build_model_with_cfg
    load_pretrained(
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/timm/models/_builder.py", line 226, in load_pretrained
    state_dict = load_state_dict_from_hf(pretrained_loc, weights_only=True, cache_dir=cache_dir)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/timm/models/_hub.py", line 226, in load_state_dict_from_hf
    cached_safe_file = hf_hub_download(
                       ^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 89, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/huggingface_hub/file_download.py", line 1032, in hf_hub_download
    return _hf_hub_download_to_cache_dir(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/huggingface_hub/file_download.py", line 1165, in _hf_hub_download_to_cache_dir
    _get_metadata_or_catch_error(
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/huggingface_hub/file_download.py", line 1699, in _get_metadata_or_catch_error
    metadata = get_hf_file_metadata(
               ^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/huggingface_hub/utils/_validators.py", line 89, in _inner_fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/huggingface_hub/file_download.py", line 1622, in get_hf_file_metadata
    response = _httpx_follow_relative_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/huggingface_hub/file_download.py", line 302, in _httpx_follow_relative_redirects
    response = http_backoff(
               ^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 506, in http_backoff
    return next(
           ^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/huggingface_hub/utils/_http.py", line 414, in _http_backoff_base
    response = client.request(method=method, url=url, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/httpx/_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/httpx/_client.py", line 914, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/httpx/_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/httpx/_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/httpx/_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/httpx/_transports/default.py", line 249, in handle_request
    with map_httpcore_exceptions():
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/work/home/shiyan_dong/miniconda3/envs/gamma/lib/python3.12/site-packages/httpx/_transports/default.py", line 118, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ProxyError: 503 Service Unavailable
